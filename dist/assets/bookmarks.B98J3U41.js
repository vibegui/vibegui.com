import{a as l,R as M,j as t}from"./react.Cu7fmCo9.js";import{P as ne}from"./index.LY3Qe_MF.js";import{s as ce,B as ie,c as de,g as ue}from"./bookmark-modal.D_NTTl-S.js";import"./react-dom.Ch-CG1a-.js";import"./markdown.BaswSlok.js";function f(a,b){return a?.includes(b)??!1}const xe={github:/github\.com/i,linkedin:/linkedin\.com/i,twitter:/twitter\.com|x\.com/i,youtube:/youtube\.com|youtu\.be/i,instagram:/instagram\.com/i,medium:/medium\.com/i,substack:/substack\.com/i,reddit:/reddit\.com/i,hackernews:/news\.ycombinator\.com/i,discord:/discord\.com|discord\.gg/i};function O(a){for(const[b,F]of Object.entries(xe))if(F.test(a))return b;return null}const i={mcp:{label:"MCP Developer",color:"#8b5cf6",icon:"ðŸ”Œ"},founder:{label:"Startup Founder",color:"#f59300",icon:"ðŸš€"},investor:{label:"VC Investor",color:"#10b981",icon:"ðŸ’°"}},me=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1");function fe({stars:a}){return a?t.jsxs("span",{title:`${a}/5`,children:["â­".repeat(a),t.jsx("span",{className:"opacity-30",children:"â˜†".repeat(5-a)})]}):t.jsx("span",{className:"text-gray-400",children:"â€”"})}function je(){const[a,b]=l.useState([]),[F,V]=l.useState(!0),[$,G]=l.useState(null),[d,U]=l.useState(""),[C,W]=l.useState(null),[j,q]=l.useState(null),[N,H]=l.useState(null),[h,J]=l.useState("analyzed"),[S,Q]=l.useState(null),[w,X]=l.useState(null),[R,Y]=l.useState(!1),[A,Z]=l.useState(!1),[B,ee]=l.useState(!1),[p,te]=l.useState("all"),[x,T]=l.useState(null),[_,g]=l.useState(null),v=l.useRef([]),[y,E]=l.useState(null),[re,z]=l.useState(!1),m=(e,r="dev")=>{T({url:e,tab:r})};M.useEffect(()=>{async function e(){try{const r=await ue();b(r)}catch(r){G(r.message)}finally{V(!1)}}e()},[]),M.useEffect(()=>{if(d.length<3){E(null);return}const e=setTimeout(async()=>{z(!0);try{const r=await ce(d);E(r)}catch(r){console.error("Search failed:",r),E(null)}finally{z(!1)}},300);return()=>clearTimeout(e)},[d]),M.useEffect(()=>{const e=r=>{if(x)return;const o=v.current;if(o.length!==0)if(r.key==="ArrowDown"||r.key==="j")r.preventDefault(),g(s=>s===null?0:Math.min(s+1,o.length-1));else if(r.key==="ArrowUp"||r.key==="k")r.preventDefault(),g(s=>s===null?0:Math.max(s-1,0));else if(r.key==="Enter"&&_!==null){const s=o[_];s&&m(s.url)}else r.key==="Escape"&&g(null)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[x,_]);const se=()=>{T(null)},c=x?a.find(e=>e.url===x.url):null,n=a.filter(e=>e.classified_at),K=n.flatMap(e=>e.tags||[]),D=[...new Set(K.filter(e=>e.startsWith("tech:")))].map(e=>e.replace("tech:","")).sort(),I=[...new Set(K.filter(e=>e.startsWith("type:")))].map(e=>e.replace("type:","")).sort(),L=[...new Set(n.map(e=>O(e.url)).filter(Boolean))].sort(),P=(y?y.map(e=>e.bookmark):n).filter(e=>{if(C==="mcp"&&!f(e.tags,"persona:mcp_developer")||C==="founder"&&!f(e.tags,"persona:startup_founder")||C==="investor"&&!f(e.tags,"persona:vc_investor")||j&&!f(e.tags,`tech:${j}`)||N&&!f(e.tags,`type:${N}`)||S&&(e.stars||0)<S||w&&O(e.url)!==w)return!1;if(d.length>0&&d.length<3){const r=d.toLowerCase();if(!e.title?.toLowerCase().includes(r)&&!e.url.toLowerCase().includes(r)&&!e.description?.toLowerCase().includes(r))return!1}if(y&&p!=="all"){const r=y.find(o=>o.bookmark.url===e.url);if(r&&(p==="content"&&!r.matches.content||p==="research"&&!r.matches.research||p==="insight"&&!r.matches.insight))return!1}return!0}).sort((e,r)=>{if(h==="alpha")return(e.title||"").localeCompare(r.title||"");if(h==="rating")return(r.stars||0)-(e.stars||0);if(h==="published"){const o=e.published_at?new Date(e.published_at).getTime():0;return(r.published_at?new Date(r.published_at).getTime():0)-o}if(h==="analyzed"){const o=e.classified_at?new Date(e.classified_at).getTime():0;return(r.classified_at?new Date(r.classified_at).getTime():0)-o}return 0});v.current=P;const u=8,oe=R?D:D.slice(0,u),le=A?I:I.slice(0,u),ae=B?L:L.slice(0,u);return F?t.jsx("div",{className:"container py-16",children:t.jsx("div",{className:"text-center",style:{color:"var(--color-fg-muted)"},children:"Loading bookmarks..."})}):$?t.jsx("div",{className:"container py-16",children:t.jsxs("div",{className:"text-center text-red-500",children:["Error: ",$]})}):t.jsxs("div",{className:"container py-8",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(ne,{title:"Bookmarks",subtitle:`${n.length} curated links`}),me&&t.jsx("a",{href:"/bookmarks/edit",className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:"var(--color-accent)",color:"#fff"},children:"âœï¸ Edit"})]}),t.jsxs("div",{className:"p-4 rounded-xl mb-6",style:{backgroundColor:"var(--color-bg-secondary)",border:"1px solid var(--color-border)"},children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Search bookmarks... (3+ chars for full-text)",value:d,onChange:e=>U(e.target.value),className:"w-full px-4 py-2 rounded-lg text-sm",style:{backgroundColor:"var(--color-bg)",border:"1px solid var(--color-border)",color:"var(--color-fg)"}}),re&&t.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs",style:{color:"var(--color-fg-muted)"},children:"Searching..."})]}),y&&t.jsx("div",{className:"flex gap-2 mt-2",children:["all","content","research","insight"].map(e=>t.jsx("button",{type:"button",onClick:()=>te(e),className:"px-2 py-1 rounded text-xs transition-colors",style:{backgroundColor:p===e?"var(--color-accent)":"var(--color-bg)",color:p===e?"#fff":"var(--color-fg-muted)",border:"1px solid var(--color-border)"},children:e==="all"?"All matches":e==="content"?"ðŸ“„ Content":e==="research"?"ðŸ”¬ Research":"ðŸ’¡ Insights"},e))})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[t.jsx("span",{className:"text-xs font-medium",style:{color:"var(--color-fg-muted)"},children:"Track:"}),["mcp","founder","investor"].map(e=>{const r=i[e],o=C===e;return t.jsxs("button",{type:"button",onClick:()=>W(o?null:e),className:"px-2 py-1 rounded text-xs transition-colors",style:{backgroundColor:o?r.color:"var(--color-bg)",color:o?"#fff":"var(--color-fg-muted)",border:`1px solid ${o?r.color:"var(--color-border)"}`},children:[r.icon," ",r.label]},e)})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[t.jsx("span",{className:"text-xs font-medium",style:{color:"var(--color-fg-muted)"},children:"Tech:"}),oe.map(e=>t.jsx("button",{type:"button",onClick:()=>q(j===e?null:e),className:"px-2 py-0.5 rounded text-xs transition-colors",style:{backgroundColor:j===e?"var(--color-accent)":"var(--color-bg)",color:j===e?"#fff":"var(--color-fg-muted)",border:"1px solid var(--color-border)"},children:e},e)),D.length>u&&t.jsx("button",{type:"button",onClick:()=>Y(!R),className:"px-2 py-0.5 rounded text-xs",style:{color:"var(--color-accent)"},children:R?"Less":`+${D.length-u} more`})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[t.jsx("span",{className:"text-xs font-medium",style:{color:"var(--color-fg-muted)"},children:"Type:"}),le.map(e=>t.jsx("button",{type:"button",onClick:()=>H(N===e?null:e),className:"px-2 py-0.5 rounded text-xs transition-colors",style:{backgroundColor:N===e?"var(--color-accent)":"var(--color-bg)",color:N===e?"#fff":"var(--color-fg-muted)",border:"1px solid var(--color-border)"},children:e},e)),I.length>u&&t.jsx("button",{type:"button",onClick:()=>Z(!A),className:"px-2 py-0.5 rounded text-xs",style:{color:"var(--color-accent)"},children:A?"Less":`+${I.length-u} more`})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[t.jsx("span",{className:"text-xs font-medium",style:{color:"var(--color-fg-muted)"},children:"Platform:"}),ae.map(e=>t.jsx("button",{type:"button",onClick:()=>X(w===e?null:e),className:"px-2 py-0.5 rounded text-xs transition-colors",style:{backgroundColor:w===e?"var(--color-accent)":"var(--color-bg)",color:w===e?"#fff":"var(--color-fg-muted)",border:"1px solid var(--color-border)"},children:e},e)),L.length>u&&t.jsx("button",{type:"button",onClick:()=>ee(!B),className:"px-2 py-0.5 rounded text-xs",style:{color:"var(--color-accent)"},children:B?"Less":`+${L.length-u} more`})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs font-medium",style:{color:"var(--color-fg-muted)"},children:"Min Stars:"}),[1,2,3,4,5].map(e=>t.jsx("button",{type:"button",onClick:()=>Q(S===e?null:e),className:"transition-opacity",style:{opacity:S===e?1:.4},children:"â­".repeat(e)},e))]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs font-medium",style:{color:"var(--color-fg-muted)"},children:"Sort:"}),["analyzed","published","rating","alpha","none"].map(e=>t.jsx("button",{type:"button",onClick:()=>J(e),className:"px-2 py-0.5 rounded text-xs transition-colors",style:{backgroundColor:h===e?"var(--color-accent)":"var(--color-bg)",color:h===e?"#fff":"var(--color-fg-muted)",border:"1px solid var(--color-border)"},title:{analyzed:"Sort by date analyzed",published:"Sort by publish date",rating:"Sort by rating",alpha:"Sort alphabetically",none:"Default order"}[e],children:{analyzed:"ðŸ”¬",published:"ðŸ“…",rating:"â­",alpha:"ðŸ”¤",none:"â€”"}[e]},e))]})]})]}),t.jsxs("div",{className:"mb-4 text-sm",style:{color:"var(--color-fg-muted)"},children:["Showing ",P.length," of ",n.length," bookmarks",d&&y&&` (search: "${d}")`]}),t.jsx("div",{className:"rounded-xl overflow-hidden",style:{backgroundColor:"var(--color-bg-secondary)",border:"1px solid var(--color-border)"},children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"text-left text-xs",style:{backgroundColor:"var(--color-bg)",color:"var(--color-fg-muted)"},children:[t.jsx("th",{className:"p-3 w-12",children:"Icon"}),t.jsx("th",{className:"p-3",children:"Title"}),t.jsx("th",{className:"p-3 w-24",children:"Rating"}),t.jsx("th",{className:"p-3 w-40",children:"Insights"}),t.jsx("th",{className:"p-3 w-28",children:"Published"}),t.jsx("th",{className:"p-3 w-28",children:"Analyzed"})]})}),t.jsx("tbody",{children:P.map((e,r)=>{const o=_===r;return t.jsxs("tr",{className:"border-t transition-colors cursor-pointer",style:{borderColor:"var(--color-border)",backgroundColor:o?"var(--color-bg)":"transparent"},onClick:()=>m(e.url),onKeyDown:s=>{s.key==="Enter"&&m(e.url)},onMouseEnter:()=>g(r),children:[t.jsx("td",{className:"p-3 text-center text-xl",children:e.icon||"ðŸ”—"}),t.jsxs("td",{className:"p-3",children:[t.jsx("div",{className:"font-medium truncate max-w-md",style:{color:"var(--color-fg)"},title:e.title||e.url,children:e.title||e.url}),t.jsx("div",{className:"text-xs truncate max-w-md",style:{color:"var(--color-fg-muted)"},children:e.description||new URL(e.url).hostname})]}),t.jsx("td",{className:"p-3",children:t.jsx(fe,{stars:e.stars})}),t.jsx("td",{className:"p-3",children:e.classified_at?t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),m(e.url,"dev")},className:"px-1.5 py-0.5 rounded text-xs transition-transform cursor-pointer hover:scale-110",style:{backgroundColor:`${i.mcp.color}20`,color:i.mcp.color},title:"Dev Insight",children:i.mcp.icon}),t.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),m(e.url,"founder")},className:"px-1.5 py-0.5 rounded text-xs transition-transform cursor-pointer hover:scale-110",style:{backgroundColor:`${i.founder.color}20`,color:i.founder.color},title:"Founder Insight",children:i.founder.icon}),t.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),m(e.url,"investor")},className:"px-1.5 py-0.5 rounded text-xs transition-transform cursor-pointer hover:scale-110",style:{backgroundColor:`${i.investor.color}20`,color:i.investor.color},title:"Investor Insight",children:i.investor.icon}),t.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),m(e.url,"research")},className:"px-1.5 py-0.5 rounded text-xs transition-transform cursor-pointer hover:scale-110",style:{backgroundColor:"#3b82f620",color:"#3b82f6"},title:"Research",children:"ðŸ”¬"}),t.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),m(e.url,"exa")},className:"px-1.5 py-0.5 rounded text-xs transition-transform cursor-pointer hover:scale-110",style:{backgroundColor:"#06b6d420",color:"#06b6d4"},title:"Page Content",children:"ðŸŒ"})]}):t.jsx("span",{className:"text-gray-500 text-xs",children:"â€”"})}),t.jsx("td",{className:"p-3 text-xs",style:{color:"var(--color-fg-muted)"},children:e.published_at?new Date(e.published_at).toLocaleDateString():"â€”"}),t.jsx("td",{className:"p-3 text-xs",style:{color:"var(--color-fg-muted)"},children:e.classified_at?new Date(e.classified_at).toLocaleDateString():"â€”"})]},e.url)})})]})})}),P.length===0&&t.jsx("div",{className:"text-center py-16",children:t.jsx("p",{style:{color:"var(--color-fg-muted)"},children:"No bookmarks match your filters"})}),n.length>0&&t.jsxs("div",{className:"mt-6 p-4 rounded-lg grid grid-cols-2 md:grid-cols-4 gap-4",style:{backgroundColor:"var(--color-bg-secondary)",border:"1px solid var(--color-border)"},children:[t.jsxs("div",{children:[t.jsxs("div",{className:"text-2xl font-bold",style:{color:"var(--color-fg)"},children:[(n.reduce((e,r)=>e+(r.stars||0),0)/n.length).toFixed(1),"â­"]}),t.jsx("div",{className:"text-xs",style:{color:"var(--color-fg-muted)"},children:"Avg Rating"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",style:{color:"#8b5cf6"},children:n.filter(e=>f(e.tags,"persona:mcp_developer")).length}),t.jsx("div",{className:"text-xs",style:{color:"var(--color-fg-muted)"},children:"MCP Developer"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",style:{color:"#f59300"},children:n.filter(e=>f(e.tags,"persona:startup_founder")).length}),t.jsx("div",{className:"text-xs",style:{color:"var(--color-fg-muted)"},children:"Startup Founder"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold",style:{color:"#10b981"},children:n.filter(e=>f(e.tags,"persona:vc_investor")).length}),t.jsx("div",{className:"text-xs",style:{color:"var(--color-fg-muted)"},children:"VC Investor"})]})]}),c&&x&&t.jsx(ie,{bookmark:{url:c.url,title:c.title,icon:c.icon,published_at:c.published_at,classified_at:c.classified_at,tags:c.tags},initialTab:x.tab,onClose:se,onNavigateBookmark:e=>{const r=v.current,o=r.findIndex(s=>s.url===c.url);if(e==="next"){const s=o+1,k=r[s];s<r.length&&k&&(g(s),T({url:k.url,tab:x.tab}))}else{const s=o-1,k=r[s];s>=0&&k&&(g(s),T({url:k.url,tab:x.tab}))}},canNavigatePrev:v.current.findIndex(e=>e.url===c.url)>0,canNavigateNext:v.current.findIndex(e=>e.url===c.url)<v.current.length-1}),t.jsx("div",{className:"text-center py-6 mt-8",children:t.jsx("button",{type:"button",onClick:()=>{de(),window.location.reload()},className:"text-xs opacity-30 hover:opacity-60 transition-opacity cursor-pointer",style:{color:"var(--color-fg-muted)"},children:"Clear cached bookmarks"})})]})}export{je as Bookmarks};
